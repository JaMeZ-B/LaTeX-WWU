%!TEX root = ../LA2.tex
\section{Dualräume}
\label{sec:2.12}
	Weitere wichtige Beispiele von Räumen, die wir bisher vernachlässigt haben, sind die Dualräume von Vektorräumen.
	
\begin{definition}[Dualraum]
	\label{def:12.1}
	Sei $V$ ein $K$-Vektorraum.
	Dann heißt $V^* := \Hom_K(V,K)$ der \Index{Dualraum} von $V$, das heißt $V^*$ ist der $K$-Vektorraum aller linearen Abbildungen $\varphi\colon V \rightarrow K$ ($K$ ist unser Grundkörper aufgefasst als $K$-Vektorraum).
\end{definition}

\begin{bemerkung}
	\label{bem:12.2}
	Ist $\dim(V) < \infty$ und ist $B = \{v_1,\dots,v_n\}$ eine Basis von $V$ (und wählen wir $\{1\}$ als Basis von $K$, so erhalten wir den üblichen Isomorphismus
	\begin{align*}
		V^* = \Hom(V,K) &\longrightarrow M(1 \times n, K) \\
		\varphi &\longmapsto \mat{A}{\{1\}}{B}{\varphi}.
	\end{align*}
	Die Einträge der Matrix $A_\varphi := \mat{A}{\{1\}}{B}{\varphi}$ sind gegeben durch
	\[
		A_\varphi = (\varphi(v_1),\dots,\varphi(v_n)).
	\]
	Eine Basis von $M(1\times n,K)$ erhalten wir durch die (Einheits-)Vektoren $(e_1^T,\dots,e_n^T)$ mit $e_i^T = (0,\dots,0,1,0,\dots,0)$ (die $1$ steht an $i$-ter Stelle).
	
	Sind dann $\varphi_1 \in \varphi_n \in V^*$ mit $A_{\varphi_i} = e_i^T$, so ist $\{\varphi_1,\dots,\varphi_n\}$ eine Basis von $V^*$ (da $V^* \simeq M(1 \times n,K)$ vermöge $\varphi \mapsto A_\varphi$).
	Für $\varphi_i$ muss dann gelten:
	\[
		\varphi_i(v_j) = \delta_{ij} = \begin{cases}
			0, & \text{falls } i \neq j \\
			1, & \text{falls } i = j
		\end{cases}
	\]
\end{bemerkung}

\begin{definition}[duale Basis]
	\label{def:12.3}
	Sei $B = \{v_1,\dots,v_n\}$ eine Basis des $K$-Vektorraumes $V$ und sei $B^* = \{\varphi_1,\dots,\varphi_n\}$ wie in \autoref{bem:12.2}.
	Dann heißt $B^*$ die zu $B$ \Index{duale Basis} von $V^*$.
\end{definition}

Beachte: Wir erhalten insbesondere $\dim(V^*) = \dim(V)$ und die Wahl der Basis $B = \{v_1,\dots,v_n\}$ induziert einen Isomorphismus
\begin{align*}
	\Phi\colon V &\longrightarrow V^* \\
	\sum_{i=1}^{n} x_i v_i &\longmapsto \sum_{i=1}^{n} x_i \varphi_i.
\end{align*}

\begin{beispiel}
	\label{bsp:12.4}
	Sei $V = K^n$ mit Standardbasis $\{e_1,\dots,e_n\}$.
	Dann ist jede lineare Abbildung $\varphi \colon K^n \rightarrow K$ gegeben durch Multiplikation mit der Matrix $A_\varphi = (\varphi(e_1),\dots,\varphi(e_n)) \in M(1 \times n,K)$.
	
	Identifizieren wir $K^n$ mit $M(1 \times n, K)$ via $y \mapsto y^T$, so erhalten wir einen Isomorphismus
	\begin{align*}
		\Phi\colon K^n &\longrightarrow (K^n)^* \\
		y &\longmapsto \varphi_y \text{ mit } \varphi_y(x) = y^T \cdot x.
	\end{align*}
	Die zu $\{e_1,\dots,e_n\}$ duale Basis ist dann gerade $\{\varphi_{e_1},\dots,\varphi_{e_n}\}$, denn $\varphi_{e_i}(e_j) = e_i^T = e_j = \delta_{ij}$.
\end{beispiel}

Allgemeiner: Ist $B = \{v_1,\dots,v_n\}$ Basis von $V$ und ist $B^* = \{\varphi_1,\dots,\varphi_n\}$ die zugehörige duale Basis, so erhalten wir zugehörige Isomorphismen
\begin{align*}
	&\Phi_B\colon V \rightarrow K^n; \sum_{i=1}^{n} x_iv_i \mapsto (x_1,\dots,x_n)^T \\
	&\Phi_{B^*}\colon V^* \rightarrow K^n; \sum_{i=1}^{n} y_i\varphi_i \mapsto (y_1,\dots,y_n)^T
\end{align*}
Dann folgt für $\varphi = \sum_{j=1}^{n} y_j \varphi_j$ und $v = \sum_{i=1}^{n} x_i v_i$:
\begin{align*}
	\varphi(v) &= \sum_{j=1}^{n} y_j \varphi_j(v) = \sum_{j=1}^{n} \varphi_j \enb{\sum_{i=1}^{n} x_i v_i} = \sum_{i,j=1}^{n} y_j x_i \Underbrace{\varphi_j(v_i)}{=\delta_{ij}} \\
	&= \sum_{i=1}^{n} y_i x_i = y^Tx
\end{align*}

Beachte: Im Fall $K = \RR^n$ gilt $y^Tx = \sk{y,x}$ mit $\sk{\cdot,\cdot}$ Standard-Skalarprodukt.
Wir erhalten also einen Isomorphismus
\begin{align*}
	\Phi \colon \RR^n &\longrightarrow (\RR^n)^* \\
	y &\longmapsto \Phi(y) = [x \mapsto \sk{y,x}]
\end{align*}

\begin{satz}
	\label{satz:12.5}
	Sei $(V,\sk{\cdot,\cdot})$ ein endlich dimensionaler euklidischer $\RR$-Vektorraum.
	Dann wird durch
	\begin{align*}
		\Phi \colon V &\longrightarrow (V)^* \\
		v &\longmapsto \Phi(v) = [w \mapsto \sk{v,w}]
	\end{align*}
	ein Isomorphismus von $\RR$-Vektorräumen definiert.
\end{satz}

\begin{beweis}
	Da $\sk{\cdot,\cdot}$ linear in beiden Variablen ist, ist für alle $v \in V$ die Abbildung $w \mapsto \Phi(v)(w) = \sk{v,w}$ linear, also gilt $\Phi(v) \in V^*$.
	Da $\sk{\cdot,\cdot}$ linear in der ersten Variablen ist, ist $\Phi \colon V \rightarrow V^*$ auch linear.
	Da $\dim(V) = \dim(V^*)$, genügt es nun zu zeigen, dass $\Phi$ injektiv ist.
	Mit der Dimensionsformel folgt dann die Bijektivität.
	
	Sei dazu $v \in V$ mit $\Phi(v) = 0$.
	Dann folgt $0 = \Phi(v)(v) = \sk{v,v} = \no{v}_2^2$, also $v = 0$. \qedhere
	\qedhere
\end{beweis}

\begin{bemerkung}
	\label{bem:12.6}
	\mbox{} \\[-1.4cm]
	\begin{enumerate}[(i)]
		\item Ist $(V,\sk{\cdot,\cdot})$ ein endlich dimensionaler unitärer $\CC$-Vektorraum, so wird ähnlich wie in \autoref{satz:12.5} ein konjugiert linearer Isomorphismus $\Phi \colon V \rightarrow V^*, \Phi(v)(w) = \sk{v,w}$ definiert.
		Der Beweis geht völlig analog.
		\item Ist $(V,\sk{\cdot,\cdot})$ wie in \autoref{satz:12.5} und ist $B = \{v_1,\dots,v_n\}$ eine Orthonormalbasis von $V$ und $\Phi \colon V \rightarrow V^*$ wie in \autoref{satz:12.5}, so ist $\{\Phi_(v_1),\dots,\Phi_(v_n)\}$ gerade die duale Basis von $V^*$ bezüglich $\{v_1,\dots,v_n\}$, denn $\Phi(v_i)(v_j) = \sk{v_i,v_j} = \delta_{ij}$.
	\end{enumerate}
\end{bemerkung}

Wir wollen nun duale lineare Abbildungen betrachten.

\begin{definition}[duale Abbildung]
	\label{def:12.7}
	Seien $V,W$ zwei $K$-Vektorräume und sei $F \colon V \rightarrow W$ linear.
	Dann heißt
	\begin{align*}
		F^*\colon W^* &\longrightarrow V^* \\
		\varphi &\longmapsto \varphi \circ F
	\end{align*}
	die zu $F$ \Index{duale Abbildung}.
\end{definition}

Beachte: Als Komposition der linearen Abbildungen $F$ und $\varphi$  ist $F^*(\varphi) = \varphi \circ F$ eine lineare Abbildung von $V$ nach $K$.
Die Abbildung $F^*$ ist linear, denn sind $\varphi, \psi \in W^*, \lambda \in K$ und $v \in V$, so gilt
\begin{align*}
	F^*(\varphi + \psi)(v) &= (\varphi + \psi) \circ F(v) = (\varphi + \psi)(F(v)) = \varphi(F(v)) + \psi(F(v)) = F^*(\varphi)(v) + F^*(\psi)(v), \\
	F^*(\lambda \varphi)(v) &= (\lambda \varphi)(F(v)) = \lambda(\varphi(F(v))) = \lambda F^*(\varphi)(v),
\end{align*}
also $F^*(\varphi + \psi) = F^*(\varphi) + F^*(\psi)$ und $F^*(\lambda \varphi) = \lambda F^*(\varphi)$.

Wir wollen als nächstes die Darstellungsmatrix von $F^*$ bezüglich dualer Basen mit Hilfe der Darstellungsmatrix von $F$ berechnen:

\begin{satz}
	\label{satz:12.8}
	Seien $V,W$ endlich dimensionale $K$-Vektorräume und seien $B = \{v_1,\dots,v_n\}$ und $\wt{B} = \{w_1,\dots,w_m\}$ Basen von $V$ und $W$.
	Ist dann $F \colon V \rightarrow W$ linear, so gilt
	\[
		\mat{A}{B^*}{\wt{B}^*}{F^*} = \enb{\mat{A}{\wt{B}}{B}{F}}^T,
	\]
	wobei $B^*$ und $\wt{B}^*$ die zu $B$ bzw. $\wt{B}$ dualen Basen von $V^*$ bzw. $W^*$ bezeichnen.
\end{satz}

\begin{beweis}
	Sei $\mat{A}{\wt{B}}{B}{F} =: A = (a_{ij})$.
	Wir müssen zeigen:
	Sind $B^* = \{\varphi_1,\dots,\varphi_n\}$ und $\wt{B}^* = \{\psi_1,\dots,\psi_m\}$, so gilt
	\[
		F^*(\psi_j) = \sum_{i=1}^{n} (a_{ij})^T \varphi_i = \sum_{i=1}^{n} a_{ji} \varphi_i
	\]
	Für $v = \sum_{l=1}^{n} \lambda_l v_l$ gilt
	\begin{align*}
		F^*(\psi_j)(v) &= \psi_j (F(v)) = \psi_j\enb{\sum_{l=1}^{n} \lambda_l F(v_l)} \\
		&= \sum_{l=1}^{n} \lambda_l \psi_j \enb{ \sum_{i=1}^{m} a_{il} w_i} = \sum_{l=1}^{n} \sum_{i=1}^{m} \lambda_l a_{il} \Underbrace{\psi_j(w_i)}{=\delta_{ji}} = \sum_{l=1}^{n} \lambda_l a_{jl}.
	\end{align*}
	Andererseits gilt
	\[
		\sum_{i=1}^{n} a_{ji} \varphi_i(v) = \sum_{i=1}^{n} \sum_{l=1}^{n} \lambda_l a_{ji} \Underbrace{\varphi_i(v_l)}{=\delta_{il}} = \sum_{l=1}^{n} \lambda_l a_{jl}. \qedhere
	\]
\end{beweis}

Insbesondere erhalten wir eine Formel für die Basiswechselmatrix von einer dualen Basis zu einer anderen:

\begin{korollar}
	\label{kor:12.9}
	Sei $V$ ein endlich dimensionaler $K$-Vektorraum und seien $B = \{v_1,\dots,v_n\}$ und $\wt{B} = \{\wt{v}_1,\dots,\wt{v}_n\}$ zwei Basen von $V$.
	Ist dann $A = \mat{A}{\wt{B}}{B}{\id_V}$ die Basiswechselmatrix von $B$ nach $\wt{B}$, so ist die Basiswechselmatrix für die Basen $B^*$ und $\wt{B}^*$ von $V^*$ gegeben durch $\mat{A}{\wt{B}^*}{B^*}{\id_{V^*}} = (A^T)^{-1}$.
\end{korollar}

\begin{beweis}
	Es gilt $\mat{A}{\wt{B}^*}{B^*}{\id_{V^*}} = \enb{\mat{A}{B^*}{\wt{B}^*}{\id}}^{-1} \stack{\ref{satz:12.8}}{=} (A^T)^{-1}$. \qedhere
\end{beweis}

\begin{anwendung}
	\label{anw:12.10}
	Sei $B = \{v_1,\dots,v_n\}$ eine Basis von $K^n$.
	Identifizieren wir $K^n$ mit $(K^n)^*$ via $y \mapsto \varphi_y(x) := y^Tx$, so wollen wir die duale Basis $\{\varphi_1,\dots,\varphi_n\}$ von $B$ als Vektoren in $K^n$ berechnen, das heißt wir suchen $y_1,\dots,y_n \in K^n$ mit $\varphi_i = \varphi_{y_i}$.
	
	Beachte: Die duale Basis der Standardbasis in diesem Bild ist wieder die Standard-Basis (\autoref{bsp:12.4}).
	Sei nun $S = (v_1,\dots,v_n) = \mat{A}{\mathcal{S}}{B}{\id_V}$.
	Nach \autoref{kor:12.9} gilt $\mat{A}{\mathcal{S}^*}{B^*}{\id_{V^*}} = (S^T)^{-1} = (S^{-1})^T$ und die Spalten dieser Matrix geben genau die Koeffizienten zur Darstellung von $y_j$ in der Basis $\mathcal{S}^*$, also folgt
	\[
		(S^T)^{-1} = (y_1,\dots,y_n).
	\]
\end{anwendung}

Wir wollen nun den doppelten Dualraum $V^{**} = (V^*)^*$ betrachten.

\begin{satz}[kanonischer Isomorphismus]
	\label{satz:12.11}
	Sei $V$ ein endlich dimensionaler $K$-Vektorraum.
	Dann ist
	\[
		\iota_V \colon V \rightarrow V^{**}, \iota(v)(\varphi) := \varphi(v)
	\]
	ein Isomorphismus.
	Ist $B = \{v_1,\dots,v_n\}$ Basis von $V$ und $\{\varphi_1,\dots,\varphi_n\}$ duale Basis von $V^*$ bezüglich $B$, so ist $\{\iota_V(v_1),\dots,\iota_V(v_n)\}$ duale Basis von $V^{**}$ bezüglich $B^*$.
\end{satz}
\newpage
Fazit: $\iota_V \colon V \rightarrow V^{**}$ überträgt die Stuktur eins zu eins von $V$ auf $V^{**}$.
Wir können daher $V$ mit $V^{**}$ in kanonischer Weise identifizieren.

Kanonisch heißt hier, dass $\iota_V \colon V \rightarrow V^{**}$ nicht von der Wahl von irgendwelchen Basen abhängt.
Im Vergleich dazu hängt der Isomorphismus $\Phi\colon V \rightarrow V^*$, $\Phi(v_i) = \varphi_i$ von der Wahl der Basis $B$ ab, ist also \textit{nicht} kanonisch. 

\begin{beweis}
	Es ist leicht nachzurechnen, dass $\iota\colon V \rightarrow V^{**}$ linear ist.
	Wegen
	\[
		\iota_V(v_j)(\varphi_i) = \varphi_i(v_j) = \delta_{ij}
	\]
	ist $\{\iota(v_1),\dots,\iota(v_j)\}$ duale Basis von $V^{**}$ bezüglich $B^*$.
	Damit folgt $\iota_V(V) = V^{**}$, also ist $\iota_V$ surjektiv.
	Wegen $\dim(V^{**}) = \dim(V^*) = \dim(V)$ ist $\iota_V$ dann auch injektiv, also ein Isomorphismus. \qedhere
\end{beweis}

Bemerkung: Die Abbildung $\iota_V \colon V \rightarrow V^{**}$ ist auch ein wohldefinierter injektiver Homomorphismus, wenn $\dim(V) = \infty$.
In diesem Fall ist $\iota_V \colon V \rightarrow V^{**}$ aber niemals bijektiv!

\begin{satz}
	\label{satz:12.12}
	Es seien $V,W$ endlich dimensionaler $K$-Vektorräume und sei $F \colon V \rightarrow W$ linear.
	Dann ist das folgende Diagramm kommutativ:
	\[
		\begin{tikzcd}
			V \arrow[r,"F"] \arrow[d,"\iota_V"'] & W \arrow[d,"\iota_W"] \\
			V^{**} \arrow[r,"F^{**}"] & W^{**}
		\end{tikzcd}
	\]
	Identifizieren wir $V$ mit $V^{**}$ und $W$ mit $W^{**}$ vermöge $\iota_V$ bzw. $\iota_W$, so folgt $F^{**} = F$.
\end{satz}

\begin{beweis}
	Wir müssen zeigen:
	Ist $v \in V$, so gilt $\iota_W(F(V)) = F^*(\iota_V(v))$.
	
	Für jedes $\psi \in W^*$ gilt zunächst
	\[
		\iota_W(F(v))(\psi) = \psi(F(v)).
	\]
	Auf der anderen Seite gilt
	\begin{align*}
		F^{**}(\iota_V(v))(\psi) &= (\iota_V(v) \circ F^*)(\psi) = \iota_V(v)(\psi \circ F) \\
		&= \psi \circ F(v) = \psi(F(v)). \qedhere
	\end{align*}
\end{beweis}

Wir wollen nun noch den Dualraum von Untervektorräumen und Quotienten $V$ mit $V^*$ in Zusammenhang bringen.
Wir starten mit: